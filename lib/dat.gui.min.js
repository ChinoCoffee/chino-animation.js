/**
 * dat-gui JavaScript Controller Library (forked version for a easing function)
 * https://github.com/ChinoCoffee/dat.gui
 *
 * Copyright 2011 Data Arts Team, Google Creative Lab
 *           2016 unikko (chino.coffee.1204@gmail.com)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 */
var dat=dat||{};dat.gui=dat.gui||{};dat.utils=dat.utils||{};dat.controllers=dat.controllers||{};dat.dom=dat.dom||{};dat.color=dat.color||{};dat.easing=dat.easing||{};dat.utils.css=function(){return{load:function(d,a){a=a||document;var k=a.createElement("link");k.type="text/css";k.rel="stylesheet";k.href=d;a.getElementsByTagName("head")[0].appendChild(k)},inject:function(d,a){a=a||document;var k=document.createElement("style");k.type="text/css";k.innerHTML=d;a.getElementsByTagName("head")[0].appendChild(k)}}}();
dat.utils.common=function(){var d=Array.prototype.forEach,a=Array.prototype.slice;return{BREAK:{},extend:function(k){this.each(a.call(arguments,1),function(a){for(var e in a)this.isUndefined(a[e])||(k[e]=a[e])},this);return k},defaults:function(k){this.each(a.call(arguments,1),function(a){for(var e in a)this.isUndefined(k[e])&&(k[e]=a[e])},this);return k},compose:function(){var k=a.call(arguments);return function(){for(var b=a.call(arguments),e=k.length-1;0<=e;e--)b=[k[e].apply(this,b)];return b[0]}},
each:function(a,b,e){if(a)if(d&&a.forEach&&a.forEach===d)a.forEach(b,e);else if(a.length===a.length+0)for(var c=0,q=a.length;c<q&&!(c in a&&b.call(e,a[c],c)===this.BREAK);c++);else for(c in a)if(b.call(e,a[c],c)===this.BREAK)break},defer:function(a){setTimeout(a,0)},toArray:function(k){return k.toArray?k.toArray():a.call(k)},isUndefined:function(a){return void 0===a},isNull:function(a){return null===a},isNaN:function(a){return a!==a},isArray:Array.isArray||function(a){return a.constructor===Array},
isObject:function(a){return a===Object(a)},isNumber:function(a){return a===a+0},isString:function(a){return a===a+""},isBoolean:function(a){return!1===a||!0===a},isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)}}}();
dat.controllers.Controller=function(d){var a=function(a,b){this.initialValue=a[b];this.domElement=document.createElement("div");this.object=a;this.property=b;this.__onFinishChange=this.__onChange=void 0};d.extend(a.prototype,{onChange:function(a){this.__onChange=a;return this},onFinishChange:function(a){this.__onFinishChange=a;return this},setValue:function(a){this.object[this.property]=a;this.__onChange&&this.__onChange.call(this,a);this.updateDisplay();return this},getValue:function(){return this.object[this.property]},
updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}});return a}(dat.utils.common);
dat.dom.dom=function(d){function a(c){if("0"===c||d.isUndefined(c))return 0;c=c.match(b);return d.isNull(c)?0:parseFloat(c[1])}var k={};d.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(c,a){d.each(c,function(c){k[c]=a})});var b=/(\d+(\.\d+)?)px/,e={makeSelectable:function(c,a){void 0!==c&&void 0!==c.style&&(c.onselectstart=a?function(){return!1}:function(){},c.style.MozUserSelect=a?"auto":"none",c.style.KhtmlUserSelect=
a?"auto":"none",c.unselectable=a?"on":"off")},makeFullscreen:function(c,a,f){d.isUndefined(a)&&(a=!0);d.isUndefined(f)&&(f=!0);c.style.position="absolute";a&&(c.style.left=0,c.style.right=0);f&&(c.style.top=0,c.style.bottom=0)},fakeEvent:function(c,a,f,g){f=f||{};var m=k[a];if(!m)throw Error("Event type "+a+" not supported.");var e=document.createEvent(m);switch(m){case "MouseEvents":e.initMouseEvent(a,f.bubbles||!1,f.cancelable||!0,window,f.clickCount||1,0,0,f.x||f.clientX||0,f.y||f.clientY||0,!1,
!1,!1,!1,0,null);break;case "KeyboardEvents":m=e.initKeyboardEvent||e.initKeyEvent;d.defaults(f,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0});m(a,f.bubbles||!1,f.cancelable,window,f.ctrlKey,f.altKey,f.shiftKey,f.metaKey,f.keyCode,f.charCode);break;default:e.initEvent(a,f.bubbles||!1,f.cancelable||!0)}d.defaults(e,g);c.dispatchEvent(e)},bind:function(a,b,f,g){a.addEventListener?a.addEventListener(b,f,g||!1):a.attachEvent&&a.attachEvent("on"+b,f);return e},
unbind:function(a,b,f,g){a.removeEventListener?a.removeEventListener(b,f,g||!1):a.detachEvent&&a.detachEvent("on"+b,f);return e},addClass:function(a,b){if(void 0===a.className)a.className=b;else if(a.className!==b){var f=a.className.split(/ +/);-1==f.indexOf(b)&&(f.push(b),a.className=f.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return e},removeClass:function(a,b){if(b){if(void 0!==a.className)if(a.className===b)a.removeAttribute("class");else{var f=a.className.split(/ +/),g=f.indexOf(b);-1!=
g&&(f.splice(g,1),a.className=f.join(" "))}}else a.className=void 0;return e},hasClass:function(a,e){return(new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)")).test(a.className)||!1},getWidth:function(c){c=getComputedStyle(c);return a(c["border-left-width"])+a(c["border-right-width"])+a(c["padding-left"])+a(c["padding-right"])+a(c.width)},getHeight:function(c){c=getComputedStyle(c);return a(c["border-top-width"])+a(c["border-bottom-width"])+a(c["padding-top"])+a(c["padding-bottom"])+a(c.height)},getOffset:function(a){var e=
{left:0,top:0};if(a.offsetParent){do e.left+=a.offsetLeft,e.top+=a.offsetTop;while(a=a.offsetParent)}return e},isActive:function(a){return a===document.activeElement&&(a.type||a.href)}};return e}(dat.utils.common);
dat.controllers.OptionController=function(d,a,k){var b=function(e,c,d){b.superclass.call(this,e,c);var f=this;this.__select=document.createElement("select");if(k.isArray(d)){var g={};k.each(d,function(a){g[a]=a});d=g}k.each(d,function(a,c){var e=document.createElement("option");e.innerHTML=c;e.setAttribute("value",a);f.__select.appendChild(e)});this.updateDisplay();a.bind(this.__select,"change",function(){f.setValue(this.options[this.selectedIndex].value)});this.domElement.appendChild(this.__select)};
b.superclass=d;k.extend(b.prototype,d.prototype,{setValue:function(a){a=b.superclass.prototype.setValue.call(this,a);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());return a},updateDisplay:function(){this.__select.value=this.getValue();return b.superclass.prototype.updateDisplay.call(this)}});return b}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);
dat.controllers.NumberController=function(d,a){function k(a){a=a.toString();return-1<a.indexOf(".")?a.length-a.indexOf(".")-1:0}var b=function(e,c,d){b.superclass.call(this,e,c);d=d||{};this.__min=d.min;this.__max=d.max;this.__step=d.step;a.isUndefined(this.__step)?this.__impliedStep=0==this.initialValue?1:Math.pow(10,Math.floor(Math.log(Math.abs(this.initialValue))/Math.LN10))/10:this.__impliedStep=this.__step;this.__precision=k(this.__impliedStep)};b.superclass=d;a.extend(b.prototype,d.prototype,
{setValue:function(a){void 0!==this.__min&&a<this.__min?a=this.__min:void 0!==this.__max&&a>this.__max&&(a=this.__max);void 0!==this.__step&&0!=a%this.__step&&(a=Math.round(a/this.__step)*this.__step);return b.superclass.prototype.setValue.call(this,a)},min:function(a){this.__min=a;return this},max:function(a){this.__max=a;return this},step:function(a){this.__impliedStep=this.__step=a;this.__precision=k(a);return this}});return b}(dat.controllers.Controller,dat.utils.common);
dat.controllers.NumberControllerBox=function(d,a,k){var b=function(e,c,d){function f(){var a=parseFloat(u.__input.value);k.isNaN(a)||u.setValue(a)}function g(a){var c=y-a.clientY;u.setValue(u.getValue()+c*u.__impliedStep);y=a.clientY}function m(){a.unbind(window,"mousemove",g);a.unbind(window,"mouseup",m)}this.__truncationSuspended=!1;b.superclass.call(this,e,c,d);var u=this,y;this.__input=document.createElement("input");this.__input.setAttribute("type","text");a.bind(this.__input,"change",f);a.bind(this.__input,
"blur",function(){f();u.__onFinishChange&&u.__onFinishChange.call(u,u.getValue())});a.bind(this.__input,"mousedown",function(c){a.bind(window,"mousemove",g);a.bind(window,"mouseup",m);y=c.clientY});a.bind(this.__input,"keydown",function(a){13===a.keyCode&&(u.__truncationSuspended=!0,this.blur(),u.__truncationSuspended=!1)});this.updateDisplay();this.domElement.appendChild(this.__input)};b.superclass=d;k.extend(b.prototype,d.prototype,{updateDisplay:function(){var a=this.__input,c;if(this.__truncationSuspended)c=
this.getValue();else{c=this.getValue();var d=Math.pow(10,this.__precision);c=Math.round(c*d)/d}a.value=c;return b.superclass.prototype.updateDisplay.call(this)}});return b}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common);
dat.controllers.NumberControllerSlider=function(d,a,k,b,e){function c(a,c,m,b,e){return b+(a-c)/(m-c)*(e-b)}var q=function(f,g,m,b,e){function d(f){f.preventDefault();var g=a.getOffset(h.__background),m=a.getWidth(h.__background);h.setValue(c(f.clientX,g.left,g.left+m,h.__min,h.__max));return!1}function k(){a.unbind(window,"mousemove",d);a.unbind(window,"mouseup",k);h.__onFinishChange&&h.__onFinishChange.call(h,h.getValue())}q.superclass.call(this,f,g,{min:m,max:b,step:e});var h=this;this.__background=
document.createElement("div");this.__foreground=document.createElement("div");a.bind(this.__background,"mousedown",function(c){a.bind(window,"mousemove",d);a.bind(window,"mouseup",k);d(c)});a.addClass(this.__background,"slider");a.addClass(this.__foreground,"slider-fg");this.updateDisplay();this.__background.appendChild(this.__foreground);this.domElement.appendChild(this.__background)};q.superclass=d;q.useDefaultStyles=function(){k.inject(e)};b.extend(q.prototype,d.prototype,{updateDisplay:function(){var a=
(this.getValue()-this.__min)/(this.__max-this.__min);this.__foreground.style.width=100*a+"%";return q.superclass.prototype.updateDisplay.call(this)}});return q}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,"/**\n * dat-gui JavaScript Controller Library\n * http://code.google.com/p/dat-gui\n *\n * Copyright 2011 Data Arts Team, Google Creative Lab\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n */\n\n.slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}");
dat.controllers.FunctionController=function(d,a,k){var b=function(e,c,d){b.superclass.call(this,e,c);var f=this;this.__button=document.createElement("div");this.__button.innerHTML=void 0===d?"Fire":d;a.bind(this.__button,"click",function(a){a.preventDefault();f.fire();return!1});a.addClass(this.__button,"button");this.domElement.appendChild(this.__button)};b.superclass=d;k.extend(b.prototype,d.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this);this.getValue().call(this.object);
this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}});return b}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);
dat.controllers.BooleanController=function(d,a,k){var b=function(e,c){b.superclass.call(this,e,c);var d=this;this.__prev=this.getValue();this.__checkbox=document.createElement("input");this.__checkbox.setAttribute("type","checkbox");a.bind(this.__checkbox,"change",function(){d.setValue(!d.__prev)},!1);this.domElement.appendChild(this.__checkbox);this.updateDisplay()};b.superclass=d;k.extend(b.prototype,d.prototype,{setValue:function(a){a=b.superclass.prototype.setValue.call(this,a);this.__onFinishChange&&
this.__onFinishChange.call(this,this.getValue());this.__prev=this.getValue();return a},updateDisplay:function(){!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1;return b.superclass.prototype.updateDisplay.call(this)}});return b}(dat.controllers.Controller,dat.dom.dom,dat.utils.common);
dat.color.toString=function(d){return function(a){if(1==a.a||d.isUndefined(a.a)){for(a=a.hex.toString(16);6>a.length;)a="0"+a;return"#"+a}return"rgba("+Math.round(a.r)+","+Math.round(a.g)+","+Math.round(a.b)+","+a.a+")"}}(dat.utils.common);
dat.color.interpret=function(d,a){var k,b,e=[{litmus:a.isString,conversions:{THREE_CHAR_HEX:{read:function(a){a=a.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===a?!1:{space:"HEX",hex:parseInt("0x"+a[1].toString()+a[1].toString()+a[2].toString()+a[2].toString()+a[3].toString()+a[3].toString())}},write:d},SIX_CHAR_HEX:{read:function(a){a=a.match(/^#([A-F0-9]{6})$/i);return null===a?!1:{space:"HEX",hex:parseInt("0x"+a[1].toString())}},write:d},CSS_RGB:{read:function(a){a=a.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);
return null===a?!1:{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3])}},write:d},CSS_RGBA:{read:function(a){a=a.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===a?!1:{space:"RGB",r:parseFloat(a[1]),g:parseFloat(a[2]),b:parseFloat(a[3]),a:parseFloat(a[4])}},write:d}}},{litmus:a.isNumber,conversions:{HEX:{read:function(a){return{space:"HEX",hex:a,conversionName:"HEX"}},write:function(a){return a.hex}}}},{litmus:a.isArray,conversions:{RGB_ARRAY:{read:function(a){return 3!=
a.length?!1:{space:"RGB",r:a[0],g:a[1],b:a[2]}},write:function(a){return[a.r,a.g,a.b]}},RGBA_ARRAY:{read:function(a){return 4!=a.length?!1:{space:"RGB",r:a[0],g:a[1],b:a[2],a:a[3]}},write:function(a){return[a.r,a.g,a.b,a.a]}}}},{litmus:a.isObject,conversions:{RGBA_OBJ:{read:function(c){return a.isNumber(c.r)&&a.isNumber(c.g)&&a.isNumber(c.b)&&a.isNumber(c.a)?{space:"RGB",r:c.r,g:c.g,b:c.b,a:c.a}:!1},write:function(a){return{r:a.r,g:a.g,b:a.b,a:a.a}}},RGB_OBJ:{read:function(c){return a.isNumber(c.r)&&
a.isNumber(c.g)&&a.isNumber(c.b)?{space:"RGB",r:c.r,g:c.g,b:c.b}:!1},write:function(a){return{r:a.r,g:a.g,b:a.b}}},HSVA_OBJ:{read:function(c){return a.isNumber(c.h)&&a.isNumber(c.s)&&a.isNumber(c.v)&&a.isNumber(c.a)?{space:"HSV",h:c.h,s:c.s,v:c.v,a:c.a}:!1},write:function(a){return{h:a.h,s:a.s,v:a.v,a:a.a}}},HSV_OBJ:{read:function(c){return a.isNumber(c.h)&&a.isNumber(c.s)&&a.isNumber(c.v)?{space:"HSV",h:c.h,s:c.s,v:c.v}:!1},write:function(a){return{h:a.h,s:a.s,v:a.v}}}}}];return function(){b=!1;
var c=1<arguments.length?a.toArray(arguments):arguments[0];a.each(e,function(e){if(e.litmus(c))return a.each(e.conversions,function(f,g){k=f.read(c);if(!1===b&&!1!==k)return b=k,k.conversionName=g,k.conversion=f,a.BREAK}),a.BREAK});return b}}(dat.color.toString,dat.utils.common);
dat.GUI=dat.gui.GUI=function(d,a,k,b,e,c,q,f,g,m,u,y,w,z,h,n){function x(a,c,f,g){if(void 0===c[f])throw Error("Object "+c+' has no property "'+f+'"');g.color?c=new u(c,f):g.easing?c=new y(c,f):(c=[c,f].concat(g.factoryArgs),c=b.apply(a,c));g.before instanceof e&&(g.before=g.before.__li);r(a,c);h.addClass(c.domElement,"c");f=document.createElement("span");h.addClass(f,"property-name");f.innerHTML=c.property;var m=document.createElement("div");m.appendChild(f);m.appendChild(c.domElement);g=v(a,m,g.before);
h.addClass(g,t.CLASS_CONTROLLER_ROW);h.addClass(g,typeof c.getValue());l(a,g,c);a.__controllers.push(c);return c}function v(a,c,f){var g=document.createElement("li");c&&g.appendChild(c);f?a.__ul.insertBefore(g,params.before):a.__ul.appendChild(g);a.onResize();return g}function l(a,m,b){b.__li=m;b.__gui=a;n.extend(b,{options:function(c){if(1<arguments.length)return b.remove(),x(a,b.object,b.property,{before:b.__li.nextElementSibling,factoryArgs:[n.toArray(arguments)]});if(n.isArray(c)||n.isObject(c))return b.remove(),
x(a,b.object,b.property,{before:b.__li.nextElementSibling,factoryArgs:[c]})},name:function(a){b.__li.firstElementChild.firstElementChild.innerHTML=a;return b},listen:function(){b.__gui.listen(b);return b},remove:function(){b.__gui.remove(b);return b}});if(b instanceof g){var e=new f(b.object,b.property,{min:b.__min,max:b.__max,step:b.__step});n.each(["updateDisplay","onChange","onFinishChange"],function(a){var K=b[a],c=e[a];b[a]=e[a]=function(){var a=Array.prototype.slice.call(arguments);K.apply(b,
a);return c.apply(e,a)}});h.addClass(m,"has-slider");b.domElement.insertBefore(e.domElement,b.domElement.firstElementChild)}else if(b instanceof f){var d=function(c){return n.isNumber(b.__min)&&n.isNumber(b.__max)?(b.remove(),x(a,b.object,b.property,{before:b.__li.nextElementSibling,factoryArgs:[b.__min,b.__max,b.__step]})):c};b.min=n.compose(d,b.min);b.max=n.compose(d,b.max)}else b instanceof c?(h.bind(m,"click",function(){h.fakeEvent(b.__checkbox,"click")}),h.bind(b.__checkbox,"click",function(a){a.stopPropagation()})):
b instanceof q?(h.bind(m,"click",function(){h.fakeEvent(b.__button,"click")}),h.bind(m,"mouseover",function(){h.addClass(b.__button,"hover")}),h.bind(m,"mouseout",function(){h.removeClass(b.__button,"hover")})):b instanceof u?(h.addClass(m,"color"),b.updateDisplay=n.compose(function(a){m.style.borderLeftColor=b.__color.toString();return a},b.updateDisplay),b.updateDisplay()):b instanceof y&&(h.addClass(m,"easing"),b.updateDisplay=n.compose(function(a){return a},b.updateDisplay),b.updateDisplay());
b.setValue=n.compose(function(c){a.getRoot().__preset_select&&b.isModified()&&H(a.getRoot(),!0);return c},b.setValue)}function r(a,b){var c=a.getRoot(),f=c.__rememberedObjects.indexOf(b.object);if(-1!=f){var g=c.__rememberedObjectIndecesToControllers[f];void 0===g&&(g={},c.__rememberedObjectIndecesToControllers[f]=g);g[b.property]=b;if(c.load&&c.load.remembered){c=c.load.remembered;if(c[a.preset])c=c[a.preset];else if(c.Default)c=c.Default;else return;c[f]&&void 0!==c[f][b.property]&&(f=c[f][b.property],
b.initialValue=f,b.setValue(f))}}}function A(a){var b=a.__save_row=document.createElement("li");h.addClass(a.domElement,"has-save");a.__ul.insertBefore(b,a.__ul.firstChild);h.addClass(b,"save-row");var c=document.createElement("span");c.innerHTML="&nbsp;";h.addClass(c,"button gears");var f=document.createElement("span");f.innerHTML="Save";h.addClass(f,"button");h.addClass(f,"save");var g=document.createElement("span");g.innerHTML="New";h.addClass(g,"button");h.addClass(g,"save-as");var m=document.createElement("span");
m.innerHTML="Revert";h.addClass(m,"button");h.addClass(m,"revert");var e=a.__preset_select=document.createElement("select");a.load&&a.load.remembered?n.each(a.load.remembered,function(b,c){I(a,c,c==a.preset)}):I(a,"Default",!1);h.bind(e,"change",function(){for(var b=0;b<a.__preset_select.length;b++)a.__preset_select[b].innerHTML=a.__preset_select[b].value;a.preset=this.value});b.appendChild(e);b.appendChild(c);b.appendChild(f);b.appendChild(g);b.appendChild(m);if(B){var d=function(){k.style.display=
a.useLocalStorage?"block":"none"},b=document.getElementById("dg-save-locally"),k=document.getElementById("dg-local-explain");b.style.display="block";b=document.getElementById("dg-local-storage");"true"===localStorage.getItem(document.location.href+".isLocal")&&b.setAttribute("checked","checked");d();h.bind(b,"change",function(){a.useLocalStorage=!a.useLocalStorage;d()})}var u=document.getElementById("dg-new-constructor");h.bind(u,"keydown",function(a){!a.metaKey||67!==a.which&&67!=a.keyCode||D.hide()});
h.bind(c,"click",function(){u.innerHTML=JSON.stringify(a.getSaveObject(),void 0,2);D.show();u.focus();u.select()});h.bind(f,"click",function(){a.save()});h.bind(g,"click",function(){var b=prompt("Enter a new preset name.");b&&a.saveAs(b)});h.bind(m,"click",function(){a.revert()})}function E(a){function b(m){m.preventDefault();g=m.clientX;h.addClass(a.__closeButton,t.CLASS_DRAG);h.bind(window,"mousemove",c);h.bind(window,"mouseup",f);return!1}function c(b){b.preventDefault();a.width+=g-b.clientX;a.onResize();
g=b.clientX;return!1}function f(){h.removeClass(a.__closeButton,t.CLASS_DRAG);h.unbind(window,"mousemove",c);h.unbind(window,"mouseup",f)}a.__resize_handle=document.createElement("div");n.extend(a.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var g;h.bind(a.__resize_handle,"mousedown",b);h.bind(a.__closeButton,"mousedown",b);a.domElement.insertBefore(a.__resize_handle,a.domElement.firstElementChild)}function J(a,b){a.domElement.style.width=
b+"px";a.__save_row&&a.autoPlace&&(a.__save_row.style.width=b+"px");a.__closeButton&&(a.__closeButton.style.width=b+"px")}function F(a,b){var c={};n.each(a.__rememberedObjects,function(f,g){var m={};n.each(a.__rememberedObjectIndecesToControllers[g],function(a,c){m[c]=b?a.initialValue:a.getValue()});c[g]=m});return c}function I(a,b,c){var f=document.createElement("option");f.innerHTML=b;f.value=b;a.__preset_select.appendChild(f);c&&(a.__preset_select.selectedIndex=a.__preset_select.length-1)}function H(a,
b){var c=a.__preset_select[a.__preset_select.selectedIndex];c.innerHTML=b?c.value+"*":c.value}function L(a){0!=a.length&&w(function(){L(a)});n.each(a,function(a){a.updateDisplay()})}d.inject(k);var B;try{B="localStorage"in window&&null!==window.localStorage}catch(K){B=!1}var D,M=!0,C,G=!1,N=[],t=function(a){function b(){var a=c.getRoot();a.width+=1;n.defer(function(){--a.width})}var c=this;this.domElement=document.createElement("div");this.__ul=document.createElement("ul");this.domElement.appendChild(this.__ul);
h.addClass(this.domElement,"dg");this.__folders={};this.__controllers=[];this.__rememberedObjects=[];this.__rememberedObjectIndecesToControllers=[];this.__listening=[];a=a||{};a=n.defaults(a,{autoPlace:!0,width:t.DEFAULT_WIDTH});a=n.defaults(a,{resizable:a.autoPlace,hideable:a.autoPlace});n.isUndefined(a.load)?a.load={preset:"Default"}:a.preset&&(a.load.preset=a.preset);n.isUndefined(a.parent)&&a.hideable&&N.push(this);a.resizable=n.isUndefined(a.parent)&&a.resizable;a.autoPlace&&n.isUndefined(a.scrollable)&&
(a.scrollable=!0);var f=B&&"true"===localStorage.getItem(document.location.href+".isLocal"),g;Object.defineProperties(this,{parent:{get:function(){return a.parent}},scrollable:{get:function(){return a.scrollable}},autoPlace:{get:function(){return a.autoPlace}},preset:{get:function(){return c.parent?c.getRoot().preset:a.load.preset},set:function(b){c.parent?c.getRoot().preset=b:a.load.preset=b;for(b=0;b<this.__preset_select.length;b++)this.__preset_select[b].value==this.preset&&(this.__preset_select.selectedIndex=
b);c.revert()}},width:{get:function(){return a.width},set:function(b){a.width=b;J(c,b)}},name:{get:function(){return a.name},set:function(b){a.name=b;e&&(e.innerHTML=a.name)}},closed:{get:function(){return a.closed},set:function(b){a.closed=b;a.closed?h.addClass(c.__ul,t.CLASS_CLOSED):h.removeClass(c.__ul,t.CLASS_CLOSED);this.onResize();c.__closeButton&&(c.__closeButton.innerHTML=b?t.TEXT_OPEN:t.TEXT_CLOSED)}},load:{get:function(){return a.load}},useLocalStorage:{get:function(){return f},set:function(a){B&&
((f=a)?h.bind(window,"unload",g):h.unbind(window,"unload",g),localStorage.setItem(document.location.href+".isLocal",a))}}});if(n.isUndefined(a.parent)){a.closed=!1;h.addClass(this.domElement,t.CLASS_MAIN);h.makeSelectable(this.domElement,!1);if(B&&f){c.useLocalStorage=!0;var m=localStorage.getItem(document.location.href+".gui");m&&(a.load=JSON.parse(m))}this.__closeButton=document.createElement("div");this.__closeButton.innerHTML=t.TEXT_CLOSED;h.addClass(this.__closeButton,t.CLASS_CLOSE_BUTTON);this.domElement.appendChild(this.__closeButton);
h.bind(this.__closeButton,"click",function(){c.closed=!c.closed})}else{void 0===a.closed&&(a.closed=!0);var e=document.createTextNode(a.name);h.addClass(e,"controller-name");m=v(c,e);h.addClass(this.__ul,t.CLASS_CLOSED);h.addClass(m,"title");h.bind(m,"click",function(a){a.preventDefault();c.closed=!c.closed;return!1});a.closed||(this.closed=!1)}a.autoPlace&&(n.isUndefined(a.parent)&&(M&&(C=document.createElement("div"),h.addClass(C,"dg"),h.addClass(C,t.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(C),
M=!1),C.appendChild(this.domElement),h.addClass(this.domElement,t.CLASS_AUTO_PLACE)),this.parent||J(c,a.width));h.bind(window,"resize",function(){c.onResize()});h.bind(this.__ul,"webkitTransitionEnd",function(){c.onResize()});h.bind(this.__ul,"transitionend",function(){c.onResize()});h.bind(this.__ul,"oTransitionEnd",function(){c.onResize()});this.onResize();a.resizable&&E(this);this.saveToLocalStorageIfPossible=g=function(){B&&"true"===localStorage.getItem(document.location.href+".isLocal")&&localStorage.setItem(document.location.href+
".gui",JSON.stringify(c.getSaveObject()))};c.getRoot();a.parent||b()};t.toggleHide=function(){G=!G;n.each(N,function(a){a.domElement.style.zIndex=G?-999:999;a.domElement.style.opacity=G?0:1})};t.CLASS_AUTO_PLACE="a";t.CLASS_AUTO_PLACE_CONTAINER="ac";t.CLASS_MAIN="main";t.CLASS_CONTROLLER_ROW="cr";t.CLASS_TOO_TALL="taller-than-window";t.CLASS_CLOSED="closed";t.CLASS_CLOSE_BUTTON="close-button";t.CLASS_DRAG="drag";t.DEFAULT_WIDTH=245;t.TEXT_CLOSED="Close Controls";t.TEXT_OPEN="Open Controls";h.bind(window,
"keydown",function(a){"text"===document.activeElement.type||72!==a.which&&72!=a.keyCode||t.toggleHide()},!1);n.extend(t.prototype,{add:function(a,b){return x(this,a,b,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(a,b){return x(this,a,b,{color:!0})},addEasingFunction:function(a,b){return x(this,a,b,{easing:!0})},remove:function(a){this.__ul.removeChild(a.__li);this.__controllers.splice(this.__controllers.indexOf(a),1);var b=this;n.defer(function(){b.onResize()})},destroy:function(){this.autoPlace&&
C.removeChild(this.domElement)},addFolder:function(a){if(void 0!==this.__folders[a])throw Error('You already have a folder in this GUI by the name "'+a+'"');var b={name:a,parent:this};b.autoPlace=this.autoPlace;this.load&&this.load.folders&&this.load.folders[a]&&(b.closed=this.load.folders[a].closed,b.load=this.load.folders[a]);b=new t(b);this.__folders[a]=b;a=v(this,b.domElement);h.addClass(a,"folder");return b},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var a=
this.getRoot();if(a.scrollable){var b=h.getOffset(a.__ul).top,c=0;n.each(a.__ul.childNodes,function(b){a.autoPlace&&b===a.__save_row||(c+=h.getHeight(b))});window.innerHeight-b-20<c?(h.addClass(a.domElement,t.CLASS_TOO_TALL),a.__ul.style.height=window.innerHeight-b-20+"px"):(h.removeClass(a.domElement,t.CLASS_TOO_TALL),a.__ul.style.height="auto")}a.__resize_handle&&n.defer(function(){a.__resize_handle.style.height=a.__ul.offsetHeight+"px"});a.__closeButton&&(a.__closeButton.style.width=a.width+"px")},
remember:function(){n.isUndefined(D)&&(D=new z,D.domElement.innerHTML=a);if(this.parent)throw Error("You can only call remember on a top level GUI.");var b=this;n.each(Array.prototype.slice.call(arguments),function(a){0==b.__rememberedObjects.length&&A(b);-1==b.__rememberedObjects.indexOf(a)&&b.__rememberedObjects.push(a)});this.autoPlace&&J(this,this.width)},getRoot:function(){for(var a=this;a.parent;)a=a.parent;return a},getSaveObject:function(){var a=this.load;a.closed=this.closed;0<this.__rememberedObjects.length&&
(a.preset=this.preset,a.remembered||(a.remembered={}),a.remembered[this.preset]=F(this));a.folders={};n.each(this.__folders,function(b,c){a.folders[c]=b.getSaveObject()});return a},save:function(){this.load.remembered||(this.load.remembered={});this.load.remembered[this.preset]=F(this);H(this,!1);this.saveToLocalStorageIfPossible()},saveAs:function(a){this.load.remembered||(this.load.remembered={},this.load.remembered.Default=F(this,!0));this.load.remembered[a]=F(this);this.preset=a;I(this,a,!0);
this.saveToLocalStorageIfPossible()},revert:function(a){n.each(this.__controllers,function(b){this.getRoot().load.remembered?r(a||this.getRoot(),b):b.setValue(b.initialValue)},this);n.each(this.__folders,function(a){a.revert(a)});a||H(this.getRoot(),!1)},listen:function(a){var b=0==this.__listening.length;this.__listening.push(a);b&&L(this.__listening)}});return t}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',
".dg {\n  /** Clear list styles */\n  /* Auto-place container */\n  /* Auto-placed GUI's */\n  /* Line items that don't contain folders. */\n  /** Folder names */\n  /** Hides closed items */\n  /** Controller row */\n  /** Name-half (left) */\n  /** Controller-half (right) */\n  /** Controller placement */\n  /** Controller placement */\n  /** Shorter number boxes when slider is present. */\n  /** Ensure the entire boolean and function row shows a hand */ }\n  .dg ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n    width: 100%;\n    clear: both; }\n  .dg.ac {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 0;\n    z-index: 0; }\n  .dg:not(.ac) .main {\n    /** Exclude mains in ac so that we don't hide close button */\n    overflow: hidden; }\n  .dg.main {\n    -webkit-transition: opacity 0.1s linear;\n    -o-transition: opacity 0.1s linear;\n    -moz-transition: opacity 0.1s linear;\n    transition: opacity 0.1s linear; }\n    .dg.main.taller-than-window {\n      overflow-y: auto; }\n      .dg.main.taller-than-window .close-button {\n        opacity: 1;\n        /* TODO, these are style notes */\n        margin-top: -1px;\n        border-top: 1px solid #2c2c2c; }\n    .dg.main ul.closed .close-button {\n      opacity: 1 !important; }\n    .dg.main:hover .close-button,\n    .dg.main .close-button.drag {\n      opacity: 1; }\n    .dg.main .close-button {\n      /*opacity: 0;*/\n      -webkit-transition: opacity 0.1s linear;\n      -o-transition: opacity 0.1s linear;\n      -moz-transition: opacity 0.1s linear;\n      transition: opacity 0.1s linear;\n      border: 0;\n      position: absolute;\n      line-height: 19px;\n      height: 20px;\n      /* TODO, these are style notes */\n      cursor: pointer;\n      text-align: center;\n      background-color: #000; }\n      .dg.main .close-button:hover {\n        background-color: #111; }\n  .dg.a {\n    float: right;\n    margin-right: 15px;\n    overflow-x: hidden; }\n    .dg.a.has-save > ul {\n      margin-top: 27px; }\n      .dg.a.has-save > ul.closed {\n        margin-top: 0; }\n    .dg.a .save-row {\n      position: fixed;\n      top: 0;\n      z-index: 1002; }\n  .dg li {\n    -webkit-transition: height 0.1s ease-out;\n    -o-transition: height 0.1s ease-out;\n    -moz-transition: height 0.1s ease-out;\n    transition: height 0.1s ease-out; }\n  .dg li:not(.folder) {\n    cursor: auto;\n    height: 27px;\n    line-height: 27px;\n    overflow: hidden;\n    padding: 0 4px 0 5px; }\n  .dg li.folder {\n    padding: 0;\n    border-left: 4px solid transparent; }\n  .dg li.title {\n    cursor: pointer;\n    margin-left: -4px; }\n  .dg .closed li:not(.title),\n  .dg .closed ul li,\n  .dg .closed ul li > * {\n    height: 0;\n    overflow: hidden;\n    border: 0; }\n  .dg .cr {\n    clear: both;\n    padding-left: 3px;\n    height: 27px; }\n  .dg .property-name {\n    cursor: default;\n    float: left;\n    clear: left;\n    width: 40%;\n    overflow: hidden;\n    text-overflow: ellipsis; }\n  .dg .c {\n    float: left;\n    width: 60%; }\n  .dg .c input[type=text] {\n    border: 0;\n    margin-top: 4px;\n    padding: 3px;\n    width: 100%;\n    float: right; }\n  .dg .c canvas {\n    border: 0;\n    margin-top: 0px;\n    outline: none;\n    border: 0;\n    width: 146px;\n    float: right; }\n  .dg .has-slider input[type=text] {\n    width: 30%;\n    /*display: none;*/\n    margin-left: 0; }\n  .dg .slider {\n    float: left;\n    width: 66%;\n    margin-left: -5px;\n    margin-right: 0;\n    height: 19px;\n    margin-top: 4px; }\n  .dg .slider-fg {\n    height: 100%; }\n  .dg .c input[type=checkbox] {\n    margin-top: 9px; }\n  .dg .c select {\n    margin-top: 5px; }\n  .dg .cr.function,\n  .dg .cr.function .property-name,\n  .dg .cr.function *,\n  .dg .cr.boolean,\n  .dg .cr.boolean * {\n    cursor: pointer; }\n  .dg .selector {\n    display: none;\n    position: absolute;\n    margin-left: -9px;\n    margin-top: 23px;\n    z-index: 10; }\n  .dg .c:hover .selector,\n  .dg .selector.drag {\n    display: block; }\n  .dg li.save-row {\n    padding: 0; }\n    .dg li.save-row .button {\n      display: inline-block;\n      padding: 0px 6px; }\n  .dg.dialogue {\n    background-color: #222;\n    width: 460px;\n    padding: 15px;\n    font-size: 13px;\n    line-height: 15px; }\n\n/* TODO Separate style and structure */\n#dg-new-constructor {\n  padding: 10px;\n  color: #222;\n  font-family: Monaco, monospace;\n  font-size: 10px;\n  border: 0;\n  resize: none;\n  box-shadow: inset 1px 1px 1px #888;\n  word-wrap: break-word;\n  margin: 12px 0;\n  display: block;\n  width: 440px;\n  overflow-y: scroll;\n  height: 100px;\n  position: relative; }\n\n#dg-local-explain {\n  display: none;\n  font-size: 11px;\n  line-height: 17px;\n  border-radius: 3px;\n  background-color: #333;\n  padding: 8px;\n  margin-top: 10px; }\n  #dg-local-explain code {\n    font-size: 10px; }\n\n#dat-gui-save-locally {\n  display: none; }\n\n/** Main type */\n.dg {\n  color: #eee;\n  font: 11px 'Lucida Grande', sans-serif;\n  text-shadow: 0 -1px 0 #111;\n  /** Auto place */\n  /* Controller row, <li> */\n  /** Controllers */ }\n  .dg.main {\n    /** Scrollbar */ }\n    .dg.main::-webkit-scrollbar {\n      width: 5px;\n      background: #1a1a1a; }\n    .dg.main::-webkit-scrollbar-corner {\n      height: 0;\n      display: none; }\n    .dg.main::-webkit-scrollbar-thumb {\n      border-radius: 5px;\n      background: #676767; }\n  .dg li:not(.folder) {\n    background: #1a1a1a;\n    border-bottom: 1px solid #2c2c2c; }\n  .dg li.save-row {\n    line-height: 25px;\n    background: #dad5cb;\n    border: 0; }\n    .dg li.save-row select {\n      margin-left: 5px;\n      width: 108px; }\n    .dg li.save-row .button {\n      margin-left: 5px;\n      margin-top: 1px;\n      border-radius: 2px;\n      font-size: 9px;\n      line-height: 7px;\n      padding: 4px 4px 5px 4px;\n      background: #c5bdad;\n      color: #fff;\n      text-shadow: 0 1px 0 #b0a58f;\n      box-shadow: 0 -1px 0 #b0a58f;\n      cursor: pointer; }\n      .dg li.save-row .button.gears {\n        background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\n        height: 7px;\n        width: 8px; }\n      .dg li.save-row .button:hover {\n        background-color: #bab19e;\n        box-shadow: 0 -1px 0 #b0a58f; }\n  .dg li.folder {\n    border-bottom: 0; }\n  .dg li.title {\n    padding-left: 16px;\n    background: #000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\n    cursor: pointer;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2); }\n  .dg .closed li.title {\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==); }\n  .dg .cr.boolean {\n    border-left: 3px solid #806787; }\n  .dg .cr.function {\n    border-left: 3px solid #e61d5f; }\n  .dg .cr.number {\n    border-left: 3px solid #2FA1D6; }\n    .dg .cr.number input[type=text] {\n      color: #2FA1D6; }\n  .dg .cr.string {\n    border-left: 3px solid #1ed36f; }\n    .dg .cr.string input[type=text] {\n      color: #1ed36f; }\n  .dg .cr.easing {\n    border-left: 3px solid #ff8710;\n    height: 80px;\n    line-height: 80px; }\n  .dg .cr.function:hover, .dg .cr.boolean:hover {\n    background: #111; }\n  .dg .c input[type=text] {\n    background: #303030;\n    outline: none; }\n    .dg .c input[type=text]:hover {\n      background: #3c3c3c; }\n    .dg .c input[type=text]:focus {\n      background: #494949;\n      color: #fff; }\n  .dg .c .slider {\n    background: #303030;\n    cursor: ew-resize; }\n  .dg .c .slider-fg {\n    background: #2FA1D6; }\n  .dg .c .slider:hover {\n    background: #3c3c3c; }\n    .dg .c .slider:hover .slider-fg {\n      background: #44abda; }\n\n/*# sourceMappingURL=style.css.map */\n",
dat.controllers.factory=function(d,a,k,b,e,c,q){return function(f,g,m,u){var y=f[g];if(q.isArray(m)||q.isObject(m))return new d(f,g,m);if(q.isNumber(y))return q.isNumber(m)&&q.isNumber(u)?new k(f,g,m,u):new a(f,g,{min:m,max:u});if(q.isString(y))return new b(f,g);if(q.isFunction(y))return new e(f,g,"");if(q.isBoolean(y))return new c(f,g)}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(d,a,k){var b=
function(e,c){function d(){f.setValue(f.__input.value)}b.superclass.call(this,e,c);var f=this;this.__input=document.createElement("input");this.__input.setAttribute("type","text");a.bind(this.__input,"keyup",d);a.bind(this.__input,"change",d);a.bind(this.__input,"blur",function(){f.__onFinishChange&&f.__onFinishChange.call(f,f.getValue())});a.bind(this.__input,"keydown",function(a){13===a.keyCode&&this.blur()});this.updateDisplay();this.domElement.appendChild(this.__input)};b.superclass=d;k.extend(b.prototype,
d.prototype,{updateDisplay:function(){a.isActive(this.__input)||(this.__input.value=this.getValue());return b.superclass.prototype.updateDisplay.call(this)}});return b}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,
dat.controllers.ColorController=function(d,a,k,b,e){function c(a,b,c,f){a.style.background="";e.each(g,function(g){a.style.cssText+="background: "+g+"linear-gradient("+b+", "+c+" 0%, "+f+" 100%); "})}function q(a){a.style.background="";a.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);";a.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";
a.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";a.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);";a.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var f=function(g,d){function y(b){n(b);a.bind(window,"mousemove",n);a.bind(window,
"mouseup",w)}function w(){a.unbind(window,"mousemove",n);a.unbind(window,"mouseup",w)}function z(){var a=b(this.value);!1!==a?(v.__color.__state=a,v.setValue(v.__color.toOriginal())):this.value=v.__color.toString()}function h(){a.unbind(window,"mousemove",x);a.unbind(window,"mouseup",h)}function n(b){b.preventDefault();var c=a.getWidth(v.__saturation_field),f=a.getOffset(v.__saturation_field),g=(b.clientX-f.left+document.body.scrollLeft)/c;b=1-(b.clientY-f.top+document.body.scrollTop)/c;1<b?b=1:0>
b&&(b=0);1<g?g=1:0>g&&(g=0);v.__color.v=b;v.__color.s=g;v.setValue(v.__color.toOriginal());return!1}function x(b){b.preventDefault();var c=a.getHeight(v.__hue_field),f=a.getOffset(v.__hue_field);b=1-(b.clientY-f.top+document.body.scrollTop)/c;1<b?b=1:0>b&&(b=0);v.__color.h=360*b;v.setValue(v.__color.toOriginal());return!1}f.superclass.call(this,g,d);this.__color=new k(this.getValue());this.__temp=new k(0);var v=this;this.domElement=document.createElement("div");a.makeSelectable(this.domElement,!1);
this.__selector=document.createElement("div");this.__selector.className="selector";this.__saturation_field=document.createElement("div");this.__saturation_field.className="saturation-field";this.__field_knob=document.createElement("div");this.__field_knob.className="field-knob";this.__field_knob_border="2px solid ";this.__hue_knob=document.createElement("div");this.__hue_knob.className="hue-knob";this.__hue_field=document.createElement("div");this.__hue_field.className="hue-field";this.__input=document.createElement("input");
this.__input.type="text";this.__input_textShadow="0 1px 1px ";a.bind(this.__input,"keydown",function(a){13===a.keyCode&&z.call(this)});a.bind(this.__input,"blur",z);a.bind(this.__selector,"mousedown",function(b){a.addClass(this,"drag").bind(window,"mouseup",function(b){a.removeClass(v.__selector,"drag")})});var l=document.createElement("div");e.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"});e.extend(this.__field_knob.style,
{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(.5>this.__color.v?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1});e.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1});e.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"});e.extend(l.style,{width:"100%",height:"100%",
background:"none"});c(l,"top","rgba(0,0,0,0)","#000");e.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"});q(this.__hue_field);e.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"});a.bind(this.__saturation_field,"mousedown",y);a.bind(this.__field_knob,"mousedown",y);a.bind(this.__hue_field,"mousedown",function(b){x(b);a.bind(window,
"mousemove",x);a.bind(window,"mouseup",h)});this.__saturation_field.appendChild(l);this.__selector.appendChild(this.__field_knob);this.__selector.appendChild(this.__saturation_field);this.__selector.appendChild(this.__hue_field);this.__hue_field.appendChild(this.__hue_knob);this.domElement.appendChild(this.__input);this.domElement.appendChild(this.__selector);this.updateDisplay()};f.superclass=d;e.extend(f.prototype,d.prototype,{updateDisplay:function(){var a=b(this.getValue());if(!1!==a){var f=!1;
e.each(k.COMPONENTS,function(b){if(!e.isUndefined(a[b])&&!e.isUndefined(this.__color.__state[b])&&a[b]!==this.__color.__state[b])return f=!0,{}},this);f&&e.extend(this.__color.__state,a)}e.extend(this.__temp.__state,this.__color.__state);this.__temp.a=1;var g=.5>this.__color.v||.5<this.__color.s?255:0,d=255-g;e.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+g+
","+g+","+g+")"});this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px";this.__temp.s=1;this.__temp.v=1;c(this.__saturation_field,"left","#fff",this.__temp.toString());e.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+g+","+g+","+g+")",textShadow:this.__input_textShadow+"rgba("+d+","+d+","+d+",.7)"})}});var g=["-moz-","-o-","-webkit-","-ms-",""];return f}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(d,a,k,b){function e(a,
b,c){Object.defineProperty(a,b,{get:function(){if("RGB"===this.__state.space)return this.__state[b];q(this,b,c);return this.__state[b]},set:function(a){"RGB"!==this.__state.space&&(q(this,b,c),this.__state.space="RGB");this.__state[b]=a}})}function c(a,b){Object.defineProperty(a,b,{get:function(){if("HSV"===this.__state.space)return this.__state[b];f(this);return this.__state[b]},set:function(a){"HSV"!==this.__state.space&&(f(this),this.__state.space="HSV");this.__state[b]=a}})}function q(c,f,g){if("HEX"===
c.__state.space)c.__state[f]=a.component_from_hex(c.__state.hex,g);else if("HSV"===c.__state.space)b.extend(c.__state,a.hsv_to_rgb(c.__state.h,c.__state.s,c.__state.v));else throw"Corrupted color state";}function f(c){var f=a.rgb_to_hsv(c.r,c.g,c.b);b.extend(c.__state,{s:f.s,v:f.v});b.isNaN(f.h)?b.isUndefined(c.__state.h)&&(c.__state.h=0):c.__state.h=f.h}var g=function(){this.__state=d.apply(this,arguments);if(!1===this.__state)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||
1};g.COMPONENTS="r g b h s v hex a".split(" ");b.extend(g.prototype,{toString:function(){return k(this)},toOriginal:function(){return this.__state.conversion.write(this)}});e(g.prototype,"r",2);e(g.prototype,"g",1);e(g.prototype,"b",0);c(g.prototype,"h");c(g.prototype,"s");c(g.prototype,"v");Object.defineProperty(g.prototype,"a",{get:function(){return this.__state.a},set:function(a){this.__state.a=a}});Object.defineProperty(g.prototype,"hex",{get:function(){this.__state.hex=a.rgb_to_hex(this.r,this.g,
this.b);return this.__state.hex},set:function(a){this.__state.space="HEX";this.__state.hex=a}});return g}(dat.color.interpret,dat.color.math=function(){var d;return{hsv_to_rgb:function(a,d,b){var e=a/60-Math.floor(a/60),c=b*(1-d),q=b*(1-e*d);d=b*(1-(1-e)*d);a=[[b,d,c],[q,b,c],[c,b,d],[c,q,b],[d,c,b],[b,c,q]][Math.floor(a/60)%6];return{r:255*a[0],g:255*a[1],b:255*a[2]}},rgb_to_hsv:function(a,d,b){var e=Math.max(a,d,b),c=e-Math.min(a,d,b);if(0==e)return{h:NaN,s:0,v:0};a=(a==e?(d-b)/c:d==e?2+(b-a)/c:
4+(a-d)/c)/6;0>a&&(a+=1);return{h:360*a,s:c/e,v:e/255}},rgb_to_hex:function(a,d,b){a=this.hex_with_component(0,2,a);a=this.hex_with_component(a,1,d);return a=this.hex_with_component(a,0,b)},component_from_hex:function(a,d){return a>>8*d&255},hex_with_component:function(a,k,b){return b<<(d=8*k)|a&~(255<<d)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.controllers.EasingFunctionController=function(d,a,k,b){var e=function(c,d){function f(a,b){return[r.top+a*r.width,
r.left+(1-b)*r.height]}function g(a,b){return[0+(b.pageX-a.offsetLeft-r.left+1)/(r.width-2),1-(b.pageY-a.offsetTop-r.top-2)/r.height]}function m(a,b){l.__ctx.moveTo(r.top+a*r.width,r.left+(1-b)*r.height)}function u(a,b){l.__ctx.lineTo(r.top+a*r.width,r.left+(1-b)*r.height)}function y(a,b,c,f,g,d){l.__ctx.bezierCurveTo(r.top+a*r.width,r.left+(1-b)*r.height,r.top+c*r.width,r.left+(1-f)*r.height,r.top+g*r.width,r.left+(1-d)*r.height)}function w(){l.__ctx.beginPath()}function z(){l.__ctx.stroke()}function h(){l.__ctx.fill()}
function n(a,b,c){a=f(a,b);l.__ctx.arc(a[0],a[1],c,0,2*Math.PI)}function x(a,b,c){a=f(a,b);l.__ctx.rect(a[0]-c,a[1]-c,2*c,2*c)}function v(a){a.preventDefault();l.__point_moving=!1;l.updateDisplay()}e.superclass.call(this,c,d);var l=this;this.domElement=document.createElement("div");a.makeSelectable(this.domElement,!1);this.__func=new k(c[d]);this.__cursor=0;this.__SELECTED=Object.freeze({LEFT:808,ANCHOR:1204,RIGHT:1102});this.__mouse_over=!1;this.__point_selected=this.__point_over=null;this.__point_selected_type=
this.__SELECTED.ANCHOR;this.__point_moving=!1;var r={top:1,left:3,width:144,height:64};this.__thumbnail=document.createElement("canvas");this.__thumbnail.width=292;this.__thumbnail.height=160;this.__thumbnail.className="easing-thumbnail";this.__ctx=this.__thumbnail.getContext("2d");this.__ctx.scale(2,2);a.bind(this.__thumbnail,"contextmenu",function(a){a.preventDefault()});a.bind(this.__thumbnail,"mouseover",function(a){l.__mouse_over=!0;l.updateDisplay()});a.bind(this.__thumbnail,"mouseout",function(a){l.__mouse_over=
!1;l.__point_moving=!1;l.updateDisplay()});a.bind(this.__thumbnail,"mousedown",function(a){a.preventDefault();var b=g(this,a),c;c=Number.isInteger(l.__point_selected)?l.__func.findPointWithHandle(b[0],b[1]):l.__func.findPoint(b[0],b[1]);b=c.index;c=c.type;void 0!==b&&2==a.button&&"ANCHOR"==c&&l.__func.deletePoint(b)&&(b=void 0);void 0!==b?(l.__point_selected==b?l.__point_selected_type=c:(l.__point_selected=b,l.__point_selected_type="ANCHOR"),l.__point_moving=!0):(l.__point_selected=null,l.__point_selected_type=
null,l.__point_moving=!1);l.updateDisplay()});a.bind(this.__thumbnail,"dblclick",function(a){a.preventDefault();a=g(this,a);a=l.__func.addPoint(a[0],a[1]);l.__point_selected=a.index;l.__point_selected_type=a.type;l.__point_moving=!0;l.updateDisplay()});a.bind(this.__thumbnail,"mousemove",function(a){a.preventDefault();a=g(this,a);Number.isInteger(l.__point_selected)&&l.__point_moving?l.__func.movePoint(l.__point_selected,l.__point_selected_type,a[0],a[1]):(a=l.__func.findPoint(a[0],a[1]).index,l.__point_over=
void 0!==a?a:null);l.updateDisplay()});a.bind(this.__thumbnail,"mouseup",v);a.bind(this.__thumbnail,"mouseup",v);this.clear=function(){l.__ctx.clearRect(0,0,146,80)};this.drawRuler=function(){var a=l.__ctx;a.lineWidth=1;a.strokeStyle="#930";w();m(0,0);u(1,0);m(0,1);u(1,1);z();for(var b=0;4>=b;b++){var c=b/4.01;a.strokeStyle="#c97";w();m(c,0);u(c,-.04);z();a.strokeStyle="#333";w();m(c,.01);u(c,.99);z()}a.font="10px";a.fillStyle="#977";p=f(0,-.17);a.fillText("0.0",p[0],p[1]);p=f(.25,-.17);a.fillText(".25",
p[0]-8,p[1]);p=f(.5,-.17);a.fillText(".50",p[0]-8,p[1]);p=f(.75,-.17);a.fillText(".75",p[0]-8,p[1]);p=f(1,-.17);a.fillText("1.0",p[0]-14,p[1])};this.drawEasingFunction=function(a){var b=l.__ctx;b.strokeStyle="#fff";b.lineWidth=1;w();a.getSegments().forEach(function(a,b){m.apply(null,a.slice(0,2));y.apply(null,a.slice(2))});z();if(l.__mouse_over){b.fillStyle="#fff";b.strokeStyle="#f90";b.lineWidth=2;a.points.forEach(function(a,b){l.__mouseo_over&&b==l.__point_over||b==l.__point_selected||(w(),n(a.x,
a.y,3),l.__ctx.closePath(),h(),z())});var c;Number.isInteger(l.__point_over)&&(c=a.points[l.__point_over],b.strokeStyle="#f3d",w(),n(c.x,c.y,3),l.__ctx.closePath(),h(),z());Number.isInteger(l.__point_selected)&&(c=a.points[l.__point_selected],b.strokeStyle="#f3d",b.fillStyle="#fff",w(),m(c.x+c.l+.01,c.y),u(c.x+c.r-.01,c.y),z(),["l","r"].forEach(function(a){w();n(c.x+c[a],c.y,2);h();z()}),w(),x(c.x,c.y,3),h(),z())}};this.setCursor=function(a){var b=l.__func.calculateY(a);l.__ctx.fillStyle="#ff0";l.__ctx.strokeStyle=
"#ff0";l.__ctx.lineWidth=1;w();n(a,b,3);l.__ctx.closePath();h();w();m(a,0);u(a,1);l.__ctx.closePath();z();return b};b.extend(this.__thumbnail.style,{width:"146px",height:"80px",cursor:"crosshair"});this.updateDisplay();this.domElement.appendChild(this.__thumbnail)};e.superclass=d;b.extend(e.prototype,d.prototype,{setValue:function(a){a=e.superclass.prototype.setValue.call(this,a);this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue());return a},updateDisplay:function(){this.clear();
this.drawRuler();this.drawEasingFunction(this.__func)}});return e}(dat.controllers.Controller,dat.dom.dom,dat.easing.Easing=function(){function d(a,b){return function(c){return c<a?a:c>b?b:c}}function a(a,b,c,d){return function(e){var k=e*e,q=1-e,h=q*q;return a*q*h+3*b*h*e+3*c*q*k+d*k*e}}function k(a,b,c,d){return function(d){var e=1-d;return a*e*e+2*b*e*d+c*d*d}}function b(a){return 0<=a?1:-1}var e=d(0,1),c=function(a){var b=this;if(Array.isArray(a)&&4==a.length)["x","y","l","r"].forEach(function(c,
d){b[c]=a[d]});else if("object"===typeof a)["x","y","l","r"].forEach(function(c){b[c]=a[c]});else throw Error("Couldn't parse point arguments");},q=function(a){var b=[];(a||[{x:0,y:0,l:0,r:.5},{x:1,y:1,l:.5,r:0}]).forEach(function(a){b.push(new c(a))});this.points=b};q.Point=c;q.prototype={toString:function(){return"something"},movePoint:function(a,b,c,d){a=this.points[a];"LEFT"==b?a.l=c-a.x:"RIGHT"==b?a.r=c-a.x:(a.x=c,a.y=d);this.constrainPoints()},constrainPoints:function(){for(var a,b,c,k=0;k<
this.points.length;k++)b=this.points[k],a=0<k?this.points[k-1]:void 0,c=k!=this.points.length-1?this.points[k+1]:void 0,b.x=e(b.x),b.y=e(b.y),0==k&&(b.x=0),k==this.points.length-1&&(b.x=1),void 0!==c&&b.x>c.x&&(b.x=c.x),b.l=void 0!==a?d(a.x-b.x,0)(b.l):0,b.r=void 0!==c?d(0,c.x-b.x)(b.r):0},findPoint:function(a,b,c){c=c||.035;var d,e,k,q=Infinity,h;this.points.forEach(function(n,x){d=a-n.x;e=b-n.y;k=d*d+e*e;k<c*c&&q>k&&(q=k,h=x)});return{index:h,type:Number.isInteger(h)?"ANCHOR":void 0}},findPointWithHandle:function(a,
b,c){c=c||.035;var d,e,k,q=Infinity,h,n,x,v,l,r=this;this.points.forEach(function(A,E){x=0==E?[[A.r,"RIGHT"],[0,"ANCHOR"]]:E==r.points.length-1?[[A.l,"LEFT"],[0,"ANCHOR"]]:[[A.r,"RIGHT"],[A.l,"LEFT"],[0,"ANCHOR"]];x.forEach(function(r){v=r[0];l=r[1];d=a-A.x-v;e=b-A.y;k=d*d+e*e;k<c*c&&q>k&&(q=k,h=E,n=l)})});return{index:h,type:n}},addPoint:function(a,b){for(var d=1;d<this.points.length-1&&!(a<=this.points[d].x);d++);var e=new c({x:a,y:b,l:0,r:0});this.points.splice(d,0,e);this.constrainPoints();return e},
deletePoint:function(a){if(0==a||a==this.points.length-1)return!1;this.points.splice(a,1);return!0},getSegments:function(){for(var a=[],b,c,d=0;d<this.points.length-1;d++)b=this.points[d],c=this.points[d+1],a.push([b.x,b.y,b.x+b.r,b.y,c.x+c.l,c.y,c.x,c.y]);return a},getSegmentByX:function(a){var b;for(b=1;b<this.points.length-1&&!(a<=this.points[b].x);b++);a=this.points[b-1];b=this.points[b];return[a.x,a.y,a.x+a.r,a.y,b.x+b.l,b.y,b.x,b.y]},calculateY:function(c){c=e(c);1E-4>c&&(c=1E-4);for(var d=
this.getSegmentByX(c),m=a(d[0],d[2],d[4],d[6]),q=a(d[1],d[3],d[5],d[7]),y=k(d[0],d[2],d[4],d[6]),d=.5,w,z,h=0;20>h;h++){w=m(d)-c;if(1E-4>Math.abs(w))return q(e(d));z=y(d);d-=w/z}y=0;w=1;z=b(m(y)-c);for(var n=b(m(w)-c),x,h=0;30>h;h++){d=(y+w)/2;x=m(d)-c;if(1E-4>Math.abs(x))break;x=b(x);x==z?y=d:x==n&&(w=d)}return q(d)}};return q}(),dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||
window.msRequestAnimationFrame||function(d,a){window.setTimeout(d,1E3/60)}}(),dat.dom.CenteredDiv=function(d,a){var k=function(){this.backgroundElement=document.createElement("div");a.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"});d.makeFullscreen(this.backgroundElement);this.backgroundElement.style.position="fixed";this.domElement=document.createElement("div");
a.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"});document.body.appendChild(this.backgroundElement);document.body.appendChild(this.domElement);var b=this;d.bind(this.backgroundElement,"click",function(){b.hide()})};k.prototype.show=function(){var b=this;this.backgroundElement.style.display="block";this.domElement.style.display="block";
this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)";this.layout();a.defer(function(){b.backgroundElement.style.opacity=1;b.domElement.style.opacity=1;b.domElement.style.webkitTransform="scale(1)"})};k.prototype.hide=function(){var a=this,e=function(){a.domElement.style.display="none";a.backgroundElement.style.display="none";d.unbind(a.domElement,"webkitTransitionEnd",e);d.unbind(a.domElement,"transitionend",e);d.unbind(a.domElement,"oTransitionEnd",e)};d.bind(this.domElement,
"webkitTransitionEnd",e);d.bind(this.domElement,"transitionend",e);d.bind(this.domElement,"oTransitionEnd",e);this.backgroundElement.style.opacity=0;this.domElement.style.opacity=0;this.domElement.style.webkitTransform="scale(1.1)"};k.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-d.getWidth(this.domElement)/2+"px";this.domElement.style.top=window.innerHeight/2-d.getHeight(this.domElement)/2+"px"};return k}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common);
